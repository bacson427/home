<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ph√°o Hoa M∆∞·ª£t M√†</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #0c0c2e, #1a1a4a);
            color: white;
            min-height: 100vh;
            overflow: hidden;
            cursor: crosshair;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem;
            text-align: center;
            position: relative;
            z-index: 100;
        }
        
        h1 {
            font-size: 3rem;
            margin-bottom: 1rem;
            background: linear-gradient(45deg, #ff6b6b, #feca57);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        /* Hi·ªáu ·ª©ng ph√°o hoa t·ªëi ∆∞u */
        .firework-shell {
            position: fixed;
            pointer-events: none;
            z-index: 9999;
            transform: translateZ(0);
            will-change: transform;
        }

        .rocket {
            position: absolute;
            width: 3px;
            height: 8px;
            background: linear-gradient(to top, #ff4444, #ffff00);
            border-radius: 1px;
            animation: launch 0.8s ease-out forwards;
            transform: translateZ(0);
        }

        @keyframes launch {
            0% {
                transform: translateY(0) scale(1);
                opacity: 1;
            }
            100% {
                transform: translateY(var(--target-y)) scale(0);
                opacity: 0;
            }
        }

        .firework-particle {
            position: absolute;
            width: 4px;
            height: 4px;
            border-radius: 50%;
            animation: burst 1s ease-out forwards;
            opacity: 0;
            transform: translateZ(0);
        }

        @keyframes burst {
            0% {
                transform: translate(0, 0) scale(0);
                opacity: 1;
            }
            50% {
                transform: translate(var(--particle-x), var(--particle-y)) scale(1);
                opacity: 1;
            }
            100% {
                transform: translate(var(--particle-x), var(--particle-y)) scale(0);
                opacity: 0;
            }
        }

        .controls {
            margin: 2rem 0;
        }

        button {
            background: linear-gradient(45deg, #ff6b6b, #ee5a52);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 25px;
            cursor: pointer;
            margin: 0 10px;
            font-size: 1rem;
        }

        .stats {
            display: flex;
            justify-content: center;
            gap: 1rem;
            margin-top: 1rem;
            font-size: 0.9rem;
        }
        
        .stat-item {
            background: rgba(255, 255, 255, 0.1);
            padding: 0.8rem 1.2rem;
            border-radius: 10px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üéÜ PH√ÅO HOA M∆Ø·ª¢T M√Ä üéá</h1>
        <p>Phi√™n b·∫£n t·ªëi ∆∞u hi·ªáu nƒÉng - Kh√¥ng lag</p>
        
        <div class="controls">
            <button onclick="toggleAutoFireworks()" id="autoBtn">B·∫≠t T·ª± ƒê·ªông</button>
            <button onclick="clearAllFireworks()">D·ªçn D·∫πp</button>
        </div>
        
        <div class="stats">
            <div class="stat-item">
                <div>Ph√°o hoa: <span id="fireworkCount">0</span></div>
            </div>
            <div class="stat-item">
                <div>FPS: <span id="fps">60</span></div>
            </div>
            <div class="stat-item">
                <div>Tr·∫°ng th√°i: <span id="status">ƒêang ch·∫°y</span></div>
            </div>
        </div>
    </div>

    <script>
        class FireworkManager {
            constructor() {
                this.fireworkCount = 0;
                this.particleCount = 0;
                this.autoFireworks = false;
                this.autoInterval = null;
                this.maxFireworks = 15; // Gi·ªõi h·∫°n s·ªë ph√°o hoa c√πng l√∫c
                this.activeFireworks = 0;
                
                this.lastTime = performance.now();
                this.frameCount = 0;
                this.currentFPS = 60;
                
                this.colors = [
                    '#FF4444', '#44FF44', '#4444FF', '#FFFF44',
                    '#FF44FF', '#44FFFF', '#FF8844', '#FF44AA'
                ];
            }

            init() {
                this.startAutoFireworks();
                this.startFPSCounter();
                this.updateStats();
            }

            startFPSCounter() {
                const updateFPS = () => {
                    this.frameCount++;
                    const currentTime = performance.now();
                    if (currentTime - this.lastTime >= 1000) {
                        this.currentFPS = Math.round((this.frameCount * 1000) / (currentTime - this.lastTime));
                        this.frameCount = 0;
                        this.lastTime = currentTime;
                        this.updateStats();
                    }
                    requestAnimationFrame(updateFPS);
                };
                updateFPS();
            }

            createFirework(x, y) {
                if (this.activeFireworks >= this.maxFireworks) return;
                
                this.fireworkCount++;
                this.activeFireworks++;
                
                const shell = document.createElement('div');
                shell.className = 'firework-shell';
                shell.style.left = x + 'px';
                shell.style.bottom = '0px';

                // Rocket
                const rocket = document.createElement('div');
                rocket.className = 'rocket';
                const launchHeight = y + 30;
                rocket.style.setProperty('--target-y', '-' + launchHeight + 'px');
                
                shell.appendChild(rocket);
                document.body.appendChild(shell);

                // Explode after launch
                setTimeout(() => {
                    this.explodeFirework(x, y);
                    setTimeout(() => {
                        shell.remove();
                        this.activeFireworks--;
                    }, 1000);
                }, 800);
            }

            explodeFirework(x, y) {
                const explosion = document.createElement('div');
                explosion.className = 'firework-shell';
                explosion.style.left = x + 'px';
                explosion.style.top = y + 'px';

                // S·ªë l∆∞·ª£ng h·∫°t √≠t h∆°n ƒë·ªÉ t·ªëi ∆∞u
                const particleCount = 30 + Math.floor(Math.random() * 20);
                
                for (let i = 0; i < particleCount; i++) {
                    const particle = document.createElement('div');
                    particle.className = 'firework-particle';
                    
                    const color = this.colors[Math.floor(Math.random() * this.colors.length)];
                    particle.style.backgroundColor = color;
                    
                    const angle = Math.random() * Math.PI * 2;
                    const distance = 40 + Math.random() * 80;
                    const particleX = Math.cos(angle) * distance;
                    const particleY = Math.sin(angle) * distance;
                    
                    particle.style.setProperty('--particle-x', particleX + 'px');
                    particle.style.setProperty('--particle-y', particleY + 'px');
                    
                    explosion.appendChild(particle);
                    this.particleCount++;
                }

                document.body.appendChild(explosion);
                
                setTimeout(() => {
                    explosion.remove();
                }, 1000);
            }

            createAutoFirework() {
                if (!this.autoFireworks) return;
                
                const x = 50 + Math.random() * (window.innerWidth - 100);
                const y = 100 + Math.random() * (window.innerHeight - 200);
                this.createFirework(x, y);
            }

            startAutoFireworks() {
                this.autoFireworks = true;
                
                // B·∫Øn √≠t h∆°n nh∆∞ng ƒë·ªÅu ƒë·∫∑n
                this.autoInterval = setInterval(() => {
                    if (this.autoFireworks && this.activeFireworks < this.maxFireworks) {
                        this.createAutoFirework();
                    }
                }, 500); // Gi·∫£m t·∫ßn su·∫•t b·∫Øn
            }

            stopAutoFireworks() {
                this.autoFireworks = false;
                if (this.autoInterval) {
                    clearInterval(this.autoInterval);
                }
            }

            clearAllFireworks() {
                const fireworks = document.querySelectorAll('.firework-shell');
                fireworks.forEach(firework => firework.remove());
                this.activeFireworks = 0;
            }

            updateStats() {
                document.getElementById('fireworkCount').textContent = this.fireworkCount;
                document.getElementById('fps').textContent = this.currentFPS;
                document.getElementById('status').textContent = this.autoFireworks ? 'ƒêang ch·∫°y' : 'ƒê√£ d·ª´ng';
                document.getElementById('status').style.color = this.autoFireworks ? '#44FF44' : '#FF4444';
            }
        }

        // Kh·ªüi t·∫°o
        const fireworkManager = new FireworkManager();

        // S·ª± ki·ªán click
        document.addEventListener('click', function(e) {
            fireworkManager.createFirework(e.clientX, e.clientY);
        });

        // ƒêi·ªÅu khi·ªÉn
        function toggleAutoFireworks() {
            if (fireworkManager.autoFireworks) {
                fireworkManager.stopAutoFireworks();
                document.getElementById('autoBtn').textContent = 'B·∫≠t T·ª± ƒê·ªông';
            } else {
                fireworkManager.startAutoFireworks();
                document.getElementById('autoBtn').textContent = 'T·∫Øt T·ª± ƒê·ªông';
            }
            fireworkManager.updateStats();
        }

        function clearAllFireworks() {
            fireworkManager.clearAllFireworks();
        }

        // Kh·ªüi ƒë·ªông khi trang load
        document.addEventListener('DOMContentLoaded', function() {
            fireworkManager.init();
            
            // B·∫Øn v√†i qu·∫£ ban ƒë·∫ßu
            setTimeout(() => {
                for (let i = 0; i < 3; i++) {
                    setTimeout(() => {
                        fireworkManager.createAutoFirework();
                    }, i * 300);
                }
            }, 500);
        });

        // T·ªëi ∆∞u h√≥a performance
        window.addEventListener('load', function() {
            if ('requestIdleCallback' in window) {
                requestIdleCallback(() => {
                    console.log('Ph√°o hoa ƒë√£ s·∫µn s√†ng!');
                });
            }
        });
    </script>
</body>
</html>
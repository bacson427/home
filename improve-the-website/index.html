<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>User Feedback - nguyenbacson.io.vn</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/intl-tel-input/17.0.8/css/intlTelInput.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background-color: #f5f7fa;
            color: #333;
            line-height: 1.6;
            margin-bottom: 70px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        header {
            text-align: center;
            padding: 30px 0;
            background: linear-gradient(135deg, #1a6b3a 0%, #2c9c5c 100%);
            color: white;
            border-radius: 10px;
            margin-bottom: 30px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            position: relative;
            overflow: hidden;
        }

        .privacy-badge {
            position: absolute;
            top: 15px;
            right: 15px;
            background: rgba(255, 255, 255, 0.2);
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 0.8rem;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }

        .subtitle {
            font-size: 1.2rem;
            opacity: 0.9;
            max-width: 600px;
            margin: 0 auto;
        }

        .content {
            display: flex;
            flex-wrap: wrap;
            gap: 30px;
        }

        .form-section {
            flex: 1;
            min-width: 300px;
            background: white;
            padding: 25px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
        }

        .comments-section {
            flex: 2;
            min-width: 300px;
            background: white;
            padding: 25px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
        }

        .admin-section {
            background: white;
            padding: 25px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
            margin-top: 30px;
            border-left: 4px solid #e74c3c;
        }

        h2 {
            color: #2c3e50;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #f0f0f0;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        h2 i {
            color: #1a6b3a;
        }

        .form-group {
            margin-bottom: 20px;
            position: relative;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #2c3e50;
        }

        input, textarea, select {
            width: 100%;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 16px;
            transition: border 0.3s;
        }

        input:focus, textarea:focus, select:focus {
            border-color: #3498db;
            outline: none;
            box-shadow: 0 0 0 2px rgba(52, 152, 219, 0.2);
        }

        textarea {
            min-height: 150px;
            resize: vertical;
        }

        .btn {
            background: linear-gradient(135deg, #1a6b3a 0%, #2c9c5c 100%);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        .btn-secondary {
            background: linear-gradient(135deg, #34495e 0%, #2c3e50 100%);
        }

        .btn-danger {
            background: linear-gradient(135deg, #c0392b 0%, #e74c3c 100%);
        }

        .comment-stats {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .stat-box {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            flex: 1;
            min-width: 120px;
            text-align: center;
            border-top: 4px solid #3498db;
        }

        .stat-number {
            font-size: 1.8rem;
            font-weight: bold;
            color: #2c3e50;
        }

        .stat-label {
            font-size: 0.9rem;
            color: #7f8c8d;
        }

        .filter-controls {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .filter-controls select {
            flex: 1;
            min-width: 150px;
        }

        .privacy-notice {
            background: #eaf7ff;
            border-left: 4px solid #3498db;
            padding: 15px;
            border-radius: 4px;
            margin-top: 20px;
            font-size: 0.9rem;
        }

        .privacy-notice h3 {
            color: #2c3e50;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .password-protected {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            padding: 15px;
            border-radius: 6px;
            margin-bottom: 20px;
        }

        .admin-controls {
            display: flex;
            gap: 10px;
            margin-top: 15px;
            flex-wrap: wrap;
        }

        .comment-stats-detailed {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
        }

        .stat-category {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px;
            margin-bottom: 8px;
            background: white;
            border-radius: 6px;
            border-left: 4px solid #3498db;
        }

        .country-stat {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px;
            margin-bottom: 5px;
            background: white;
            border-radius: 4px;
        }

        .total-filtered {
            background: #eaf7ff;
            padding: 10px;
            border-radius: 6px;
            margin-bottom: 15px;
            text-align: center;
        }

        .no-comments {
            text-align: center;
            color: #7f8c8d;
            padding: 30px;
            font-style: italic;
        }

        .footer {
            background-color: #f8f9fa;
            padding: 15px 20px;
            border-top: 1px solid #e9ecef;
            text-align: center;
            font-size: 14px;
            color: #6c757d;
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            width: 100%;
            z-index: 1000;
        }

        .footer a {
            color: #007bff;
            text-decoration: none;
            margin: 0 10px;
        }

        .footer a:hover {
            text-decoration: underline;
        }

        .last-updated {
            background: #f8f9fa;
            padding: 10px;
            border-left: 4px solid #3498db;
            margin-bottom: 30px;
        }

        /* Phone input styles */
        .iti {
            width: 100%;
            margin-bottom: 5px;
        }

        .hide {
            display: none;
        }

        #valid-msg {
            color: #27ae60;
            position: absolute;
            right: 10px;
            top: 38px;
            font-size: 0.9rem;
            font-weight: 600;
        }

        #error-msg {
            color: #e74c3c;
            position: absolute;
            right: 10px;
            top: 38px;
            font-size: 0.9rem;
            font-weight: 600;
        }

        .phone-info {
            margin-top: 5px;
        }

        .phone-info small {
            color: #7f8c8d;
            font-style: italic;
        }

        @media (max-width: 768px) {
            .content {
                flex-direction: column;
            }
            h1 {
                font-size: 2rem;
            }
            .filter-controls, .admin-controls {
                flex-direction: column;
            }
            .comment-stats {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <div class="last-updated">
        <strong>Last Updated:</strong> 02:03, October 24, 2025, GMT+7
    </div>
    
    <div class="container">
        <header>
            <div class="privacy-badge">
                <i class="fas fa-shield-alt"></i> Data Protection
            </div>
            <h1>User Feedback Page</h1>
            <p class="subtitle">Share your opinions, reviews and feedback about the website. Your data is securely protected. To ensure the data of contributors, reviewers,... we will delete your feedback data and information after a period of time (non-fixed time). Your security comes first.</p>
        </header>

        <div class="content">
            <section class="form-section">
                <h2><i class="fas fa-pen"></i> Add Your Feedback</h2>
                <form id="commentForm">
                    <div class="form-group">
                        <label for="name">Full Name:</label>
                        <input type="text" id="name" placeholder="Enter your full name" required>
                    </div>

                    <div class="form-group">
                        <label for="email">Email:</label>
                        <input type="email" id="email" placeholder="Enter your email" required>
                    </div>

                    <div class="form-group">
                        <label for="phone">Phone Number (auto area code):</label>
                        <input type="tel" id="phone" placeholder="Enter your phone number">
                        <span id="valid-msg" class="hide">✓ Valid</span>
                        <span id="error-msg" class="hide"></span>
                        <div class="phone-info">
                            <small>Area code will automatically change based on your selected country</small>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="country">Country:</label>
                        <select id="country" required>
                            <option value="">Select country</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="state">State/Province:</label>
                        <select id="state" required>
                            <option value="">Select state/province</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="category">Feedback Category:</label>
                        <select id="category" required>
                            <option value="">Select category</option>
                            <option value="suggestion">Suggestion</option>
                            <option value="review">Review</option>
                            <option value="question">Q&A</option>
                            <option value="other">Other</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="comment">Your Feedback:</label>
                        <textarea id="comment" placeholder="Share your opinions, reviews or feedback..." required></textarea>
                    </div>

                    <div class="privacy-notice">
                        <h3><i class="fas fa-lock"></i> Data Protection Commitment</h3>
                        <p>Your personal information will be protected and used only for feedback management purposes. We do not share information with third parties.</p>
                    </div>

                    <button type="submit" class="btn">
                        <i class="fas fa-paper-plane"></i> Submit Feedback
                    </button>
                </form>
            </section>

            <section class="comments-section">
                <h2><i class="fas fa-comments"></i> Feedback From Users</h2>

                <div class="comment-stats">
                    <div class="stat-box">
                        <div class="stat-number" id="totalComments">0</div>
                        <div class="stat-label">Total feedback</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-number" id="todayComments">0</div>
                        <div class="stat-label">Today's feedback</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-number" id="countryCount">0</div>
                        <div class="stat-label">Countries</div>
                    </div>
                </div>

                <div class="filter-controls">
                    <select id="filterCategory">
                        <option value="">All categories</option>
                        <option value="suggestion">Suggestion</option>
                        <option value="review">Review</option>
                        <option value="question">Q&A</option>
                        <option value="other">Other</option>
                    </select>

                    <select id="filterCountry">
                        <option value="">All countries</option>
                    </select>

                    <select id="sortComments">
                        <option value="newest">Newest</option>
                        <option value="oldest">Oldest</option>
                    </select>
                </div>

                <div id="commentsList">
                    <div class="no-comments">
                        <i class="fas fa-comment-slash"></i><br>
                        No feedback yet. Be the first to share!
                    </div>
                </div>
            </section>
        </div>

        <section class="admin-section">
            <h2><i class="fas fa-user-shield"></i> Admin Area</h2>

            <div class="password-protected">
                <p><i class="fas fa-lock"></i> This area is password protected. Only administrators can access.</p>
                <div class="form-group">
                    <label for="adminPassword">Admin password:</label>
                    <input type="password" id="adminPassword" placeholder="Enter admin password">
                </div>
                <button id="adminLogin" class="btn">
                    <i class="fas fa-sign-in-alt"></i> Admin Login
                </button>
            </div>

            <div id="adminPanel" style="display: none;">
                <div class="admin-controls">
                    <button id="exportComments" class="btn btn-secondary">
                        <i class="fas fa-download"></i> Export Data
                    </button>
                    <button id="deleteAllComments" class="btn btn-danger">
                        <i class="fas fa-trash"></i> Delete All
                    </button>
                </div>

                <div class="admin-stats">
                    <h3>Data Statistics</h3>
                    <div id="adminStats"></div>
                </div>
            </div>
        </section>

        <footer>
            <p><i class="fas fa-shield-alt"></i> © 2025 User Feedback Page. All data is protected according to privacy policy.</p>
        </footer>
    </div>

    <div class="footer">
        Bản quyền © 2025 thuộc về Nguyen Bac Son. | 
        <a href="https://nguyenbacson.io.vn/privacy-policy.html">Chính Sách Bảo Mật</a>
    </div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/intl-tel-input/17.0.8/js/intlTelInput.min.js"></script>
<script>
// Country data matching phone input
const allCountries = [
    { code: 'VN', name: 'Vietnam', states: ['Hanoi', 'Ho Chi Minh', 'Da Nang', 'Hai Phong', 'Can Tho', 'An Giang', 'Ba Ria - Vung Tau', 'Bac Giang', 'Bac Kan', 'Bac Lieu', 'Bac Ninh', 'Ben Tre', 'Binh Dinh', 'Binh Duong', 'Binh Phuoc', 'Binh Thuan', 'Ca Mau', 'Cao Bang', 'Dak Lak', 'Dak Nong', 'Dien Bien', 'Dong Nai', 'Dong Thap', 'Gia Lai', 'Ha Giang', 'Ha Nam', 'Ha Tinh', 'Hai Duong', 'Hau Giang', 'Hoa Binh', 'Hung Yen', 'Khanh Hoa', 'Kien Giang', 'Kon Tum', 'Lai Chau', 'Lam Dong', 'Lang Son', 'Lao Cai', 'Long An', 'Nam Dinh', 'Nghe An', 'Ninh Binh', 'Ninh Thuan', 'Phu Tho', 'Phu Yen', 'Quang Binh', 'Quang Nam', 'Quang Ngai', 'Quang Ninh', 'Quang Tri', 'Soc Trang', 'Son La', 'Tay Ninh', 'Thai Binh', 'Thai Nguyen', 'Thanh Hoa', 'Thua Thien Hue', 'Tien Giang', 'Tra Vinh', 'Tuyen Quang', 'Vinh Long', 'Vinh Phuc', 'Yen Bai'] },
    { code: 'US', name: 'United States', states: ['Alabama', 'Alaska', 'Arizona', 'Arkansas', 'California', 'Colorado', 'Connecticut', 'Delaware', 'Florida', 'Georgia', 'Hawaii', 'Idaho', 'Illinois', 'Indiana', 'Iowa', 'Kansas', 'Kentucky', 'Louisiana', 'Maine', 'Maryland', 'Massachusetts', 'Michigan', 'Minnesota', 'Mississippi', 'Missouri', 'Montana', 'Nebraska', 'Nevada', 'New Hampshire', 'New Jersey', 'New Mexico', 'New York', 'North Carolina', 'North Dakota', 'Ohio', 'Oklahoma', 'Oregon', 'Pennsylvania', 'Rhode Island', 'South Carolina', 'South Dakota', 'Tennessee', 'Texas', 'Utah', 'Vermont', 'Virginia', 'Washington', 'West Virginia', 'Wisconsin', 'Wyoming'] },
    { code: 'CN', name: 'China', states: ['Beijing', 'Shanghai', 'Tianjin', 'Chongqing', 'Guangdong', 'Zhejiang', 'Jiangsu', 'Shandong', 'Henan', 'Hubei', 'Hunan', 'Sichuan', 'Anhui', 'Fujian', 'Heilongjiang', 'Jilin', 'Liaoning', 'Shaanxi', 'Shanxi', 'Hebei'] },
    { code: 'JP', name: 'Japan', states: ['Tokyo', 'Osaka', 'Kyoto', 'Hokkaido', 'Aichi', 'Chiba', 'Fukuoka', 'Hyogo', 'Kanagawa', 'Saitama'] },
    { code: 'KR', name: 'South Korea', states: ['Seoul', 'Busan', 'Incheon', 'Daegu', 'Daejeon', 'Gwangju', 'Ulsan', 'Gyeonggi', 'Gangwon', 'Chungcheong'] },
    { code: 'SG', name: 'Singapore', states: ['Singapore'] },
    { code: 'TH', name: 'Thailand', states: ['Bangkok', 'Chiang Mai', 'Phuket', 'Pattaya', 'Krabi', 'Samui', 'Hua Hin', 'Chiang Rai'] },
    { code: 'MY', name: 'Malaysia', states: ['Kuala Lumpur', 'Penang', 'Johor Bahru', 'Malacca', 'Ipoh', 'Kuching', 'Kota Kinabalu'] },
    { code: 'ID', name: 'Indonesia', states: ['Jakarta', 'Bali', 'Surabaya', 'Bandung', 'Medan', 'Makassar', 'Semarang'] },
    { code: 'PH', name: 'Philippines', states: ['Manila', 'Cebu', 'Davao', 'Quezon City', 'Makati', 'Cagayan de Oro', 'Bacolod'] },
    { code: 'GB', name: 'United Kingdom', states: ['London', 'Manchester', 'Birmingham', 'Liverpool', 'Edinburgh', 'Glasgow', 'Bristol', 'Leeds'] },
    { code: 'FR', name: 'France', states: ['Paris', 'Marseille', 'Lyon', 'Toulouse', 'Nice', 'Nantes', 'Strasbourg', 'Montpellier'] },
    { code: 'DE', name: 'Germany', states: ['Berlin', 'Munich', 'Hamburg', 'Cologne', 'Frankfurt', 'Stuttgart', 'Düsseldorf', 'Dortmund'] },
    { code: 'IT', name: 'Italy', states: ['Rome', 'Milan', 'Naples', 'Turin', 'Palermo', 'Genoa', 'Bologna', 'Florence'] },
    { code: 'ES', name: 'Spain', states: ['Madrid', 'Barcelona', 'Valencia', 'Seville', 'Zaragoza', 'Malaga', 'Murcia', 'Palma'] },
    { code: 'CA', name: 'Canada', states: ['Toronto', 'Vancouver', 'Montreal', 'Calgary', 'Edmonton', 'Ottawa', 'Winnipeg', 'Quebec City'] },
    { code: 'AU', name: 'Australia', states: ['Sydney', 'Melbourne', 'Brisbane', 'Perth', 'Adelaide', 'Gold Coast', 'Canberra', 'Newcastle'] }
];

document.addEventListener('DOMContentLoaded', function() {
    const commentForm = document.getElementById('commentForm');
    const commentsList = document.getElementById('commentsList');
    const filterCategory = document.getElementById('filterCategory');
    const filterCountry = document.getElementById('filterCountry');
    const sortComments = document.getElementById('sortComments');
    const adminLogin = document.getElementById('adminLogin');
    const adminPanel = document.getElementById('adminPanel');
    const exportComments = document.getElementById('exportComments');
    const deleteAllComments = document.getElementById('deleteAllComments');
    const countrySelect = document.getElementById('country');
    const stateSelect = document.getElementById('state');
    const phoneInputField = document.getElementById('phone');

    // Initialize International Telephone Input
    const phoneInput = window.intlTelInput(phoneInputField, {
        utilsScript: "https://cdnjs.cloudflare.com/ajax/libs/intl-tel-input/17.0.8/js/utils.js",
        separateDialCode: true,
        preferredCountries: ['vn', 'us', 'gb', 'ca', 'au', 'jp', 'kr', 'sg'],
        initialCountry: "auto",
        geoIpLookup: function(callback) {
            fetch('https://ipapi.co/json/')
                .then(res => res.json())
                .then(data => callback(data.country_code))
                .catch(() => callback('vn'));
        }
    });

    // Variables for phone validation
    const validMsg = document.getElementById("valid-msg");
    const errorMsg = document.getElementById("error-msg");

    // Real-time phone number validation
    function validatePhoneNumber() {
        if (phoneInput.isValidNumber()) {
            validMsg.classList.remove("hide");
            errorMsg.classList.add("hide");
            return true;
        } else {
            validMsg.classList.add("hide");
            errorMsg.classList.remove("hide");
            errorMsg.textContent = "";
            return false;
        }
    }

    // Event listeners for phone number
    phoneInputField.addEventListener('input', validatePhoneNumber);
    phoneInputField.addEventListener('blur', validatePhoneNumber);
    phoneInputField.addEventListener('countrychange', validatePhoneNumber);

    // Password mechanism
    function getRealPassword() {
        const part1 = String.fromCharCode(64); // @
        const part2 = "Son";
        const part3 = "20";
        const part4 = "07";
        return part1 + part2 + part3 + part4;
    }

    function validatePassword(input) {
        const realPassword = getRealPassword();
        return input === realPassword;
    }

    // Initialize country list
    function initializeCountries() {
        allCountries.forEach(country => {
            const option = document.createElement('option');
            option.value = country.code;
            option.textContent = country.name;
            countrySelect.appendChild(option);

            const filterOption = document.createElement('option');
            filterOption.value = country.code;
            filterOption.textContent = country.name;
            filterCountry.appendChild(filterOption);
        });
    }

    // Update state/province list when country is selected
    countrySelect.addEventListener('change', function() {
        const selectedCountry = allCountries.find(c => c.code === this.value);
        stateSelect.innerHTML = '<option value="">Select state/province</option>';

        if (selectedCountry) {
            selectedCountry.states.forEach(state => {
                const option = document.createElement('option');
                option.value = state;
                option.textContent = state;
                stateSelect.appendChild(option);
            });

            // Automatically update phone area code when country is selected
            phoneInput.setCountry(selectedCountry.code);
            validatePhoneNumber();
        }
    });

    // Load comments from localStorage when page loads
    initializeCountries();
    loadComments();
    updateStats();

    // Handle form submission
    commentForm.addEventListener('submit', function(e) {
        e.preventDefault();

        // Validate phone number
        if (!validatePhoneNumber()) {
            alert('Please enter a valid phone number!');
            phoneInputField.focus();
            return;
        }

        // Get data from form
        const name = document.getElementById('name').value;
        const email = document.getElementById('email').value;
        const phone = phoneInput.getNumber();
        const country = countrySelect.options[countrySelect.selectedIndex].text;
        const countryCode = countrySelect.value;
        const state = stateSelect.value;
        const category = document.getElementById('category').value;
        const comment = document.getElementById('comment').value;

        // Create new comment object
        const newComment = {
            id: Date.now(),
            name: name,
            email: email,
            phone: phone,
            country: country,
            countryCode: countryCode,
            state: state,
            category: category,
            comment: comment,
            date: new Date().toLocaleString('en-US'),
            dateObj: new Date()
        };

        // Save new comment
        saveComment(newComment);

        // Reset form
        commentForm.reset();
        phoneInput.setNumber("");
        stateSelect.innerHTML = '<option value="">Select state/province</option>';
        validMsg.classList.add("hide");
        errorMsg.classList.add("hide");

        // Update statistics
        updateStats();

        // Show notification
        alert('Thank you for your feedback! Your feedback has been securely saved.');
    });

    // Handle filters and search
    filterCategory.addEventListener('change', filterAndSortComments);
    filterCountry.addEventListener('change', filterAndSortComments);
    sortComments.addEventListener('change', filterAndSortComments);

    // Handle admin login
    adminLogin.addEventListener('click', function() {
        const password = document.getElementById('adminPassword').value;
        if (validatePassword(password)) {
            adminPanel.style.display = 'block';
            document.querySelector('.password-protected').style.display = 'none';
            updateAdminStats();
        } else {
            alert('Incorrect password!');
        }
    });

    // Export data
    exportComments.addEventListener('click', function() {
        const comments = JSON.parse(localStorage.getItem('userComments')) || [];
        if (comments.length === 0) {
            alert('No data to export!');
            return;
        }

        // Create CSV file content
        let csvContent = "Name,Email,Phone Number,Country,State/Province,Category,Feedback,Submission Date\n";
        comments.forEach(comment => {
            csvContent += `"${comment.name}","${comment.email}","${comment.phone}","${comment.country}","${comment.state}","${getCategoryName(comment.category)}","${comment.comment.replace(/"/g, '""')}","${comment.date}"\n`;
        });

        // Create file and download
        const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
        const url = URL.createObjectURL(blob);
        const link = document.createElement("a");
        link.setAttribute("href", url);
        link.setAttribute("download", "user_feedback.csv");
        link.style.visibility = 'hidden';
        document.body.appendChild(link);
        link.click();
        document.body.removeChild(link);
    });

    // Delete all comments
    deleteAllComments.addEventListener('click', function() {
        if (confirm('Are you sure you want to delete ALL feedback? This action cannot be undone!')) {
            localStorage.removeItem('userComments');
            commentsList.innerHTML = '<div class="no-comments"><i class="fas fa-comment-slash"></i><br>No feedback yet. Be the first to share!</div>';
            updateStats();
            updateAdminStats();
            alert('All feedback has been deleted!');
        }
    });
    // Function to save comment to localStorage
    function saveComment(comment) {
        let comments = JSON.parse(localStorage.getItem('userComments')) || [];
        comments.push(comment);
        localStorage.setItem('userComments', JSON.stringify(comments));
    }

    // Function to load comments from localStorage
    function loadComments() {
        const comments = JSON.parse(localStorage.getItem('userComments')) || [];

        if (comments.length === 0) {
            commentsList.innerHTML = '<div class="no-comments"><i class="fas fa-comment-slash"></i><br>No feedback yet. Be the first to share!</div>';
            return;
        }

        // Display statistics instead of comment list
        displayCommentStats();
    }

    // Function to display comment statistics
    function displayCommentStats() {
        const comments = JSON.parse(localStorage.getItem('userComments')) || [];

        if (comments.length === 0) {
            commentsList.innerHTML = '<div class="no-comments"><i class="fas fa-comment-slash"></i><br>No feedback yet. Be the first to share!</div>';
            return;
        }

        // Statistics by category
        const statsByCategory = {};
        const statsByCountry = {};

        comments.forEach(comment => {
            // Category statistics
            if (!statsByCategory[comment.category]) {
                statsByCategory[comment.category] = 0;
            }
            statsByCategory[comment.category]++;

            // Country statistics
            if (!statsByCountry[comment.country]) {
                statsByCountry[comment.country] = 0;
            }
            statsByCountry[comment.country]++;
        });

        // Create HTML to display statistics
        let statsHTML = '<div class="comment-stats-detailed">';
        statsHTML += '<h3><i class="fas fa-chart-bar"></i> Feedback Statistics</h3>';

        // Display statistics by category
        statsHTML += '<h4><i class="fas fa-tags"></i> By Category:</h4>';
        for (const category in statsByCategory) {
            statsHTML += `
                <div class="stat-category">
                    <span class="category-name">${getCategoryName(category)}</span>
                    <span class="category-count">${statsByCategory[category]} feedback</span>
                </div>
            `;
        }

        // Display statistics by country
        statsHTML += '<h4 style="margin-top: 20px;"><i class="fas fa-globe"></i> By Country:</h4>';
        for (const country in statsByCountry) {
            statsHTML += `
                <div class="country-stat">
                    <span class="category-name">${country}</span>
                    <span class="category-count">${statsByCountry[country]} feedback</span>
                </div>
            `;
        }

        statsHTML += '</div>';
        commentsList.innerHTML = statsHTML;
    }

    // Function to filter and sort comments
    function filterAndSortComments() {
        const comments = JSON.parse(localStorage.getItem('userComments')) || [];
        const categoryFilter = filterCategory.value;
        const countryFilter = filterCountry.value;
        const sortOrder = sortComments.value;

        // Filter by category
        let filteredComments = comments;
        if (categoryFilter) {
            filteredComments = filteredComments.filter(comment => comment.category === categoryFilter);
        }

        // Filter by country
        if (countryFilter) {
            filteredComments = filteredComments.filter(comment => comment.countryCode === countryFilter);
        }

        // Sort
        if (sortOrder === 'newest') {
            filteredComments.sort((a, b) => b.dateObj - a.dateObj);
        } else {
            filteredComments.sort((a, b) => a.dateObj - b.dateObj);
        }

        // Display statistics after filtering
        displayFilteredStats(filteredComments);
    }

    // Function to display statistics after filtering
    function displayFilteredStats(comments) {
        if (comments.length === 0) {
            commentsList.innerHTML = '<div class="no-comments"><i class="fas fa-search"></i><br>No feedback found matching the filter.</div>';
            return;
        }

        // Statistics by category
        const statsByCategory = {};
        const statsByCountry = {};

        comments.forEach(comment => {
            // Category statistics
            if (!statsByCategory[comment.category]) {
                statsByCategory[comment.category] = 0;
            }
            statsByCategory[comment.category]++;

            // Country statistics
            if (!statsByCountry[comment.country]) {
                statsByCountry[comment.country] = 0;
            }
            statsByCountry[comment.country]++;
        });

        // Create HTML to display statistics
        let statsHTML = '<div class="comment-stats-detailed">';
        statsHTML += '<h3><i class="fas fa-chart-bar"></i> Feedback Statistics</h3>';
        statsHTML += `<p class="total-filtered">Found <strong>${comments.length}</strong> matching feedback</p>`;

        // Display statistics by category
        statsHTML += '<h4><i class="fas fa-tags"></i> By Category:</h4>';
        for (const category in statsByCategory) {
            statsHTML += `
                <div class="stat-category">
                    <span class="category-name">${getCategoryName(category)}</span>
                    <span class="category-count">${statsByCategory[category]} feedback</span>
                </div>
            `;
        }

        // Display statistics by country
        statsHTML += '<h4 style="margin-top: 20px;"><i class="fas fa-globe"></i> By Country:</h4>';
        for (const country in statsByCountry) {
            statsHTML += `
                <div class="country-stat">
                    <span class="category-name">${country}</span>
                    <span class="category-count">${statsByCountry[country]} feedback</span>
                </div>
            `;
        }

        statsHTML += '</div>';
        commentsList.innerHTML = statsHTML;
    }

    // Function to update overview statistics
    function updateStats() {
        const comments = JSON.parse(localStorage.getItem('userComments')) || [];
        const today = new Date().toDateString();
        const todayComments = comments.filter(comment => 
            new Date(comment.dateObj).toDateString() === today
        ).length;

        // Count unique countries
        const uniqueCountries = [...new Set(comments.map(comment => comment.country))];

        document.getElementById('totalComments').textContent = comments.length;
        document.getElementById('todayComments').textContent = todayComments;
        document.getElementById('countryCount').textContent = uniqueCountries.length;

        // Update detailed statistics display
        displayCommentStats();
    }

    // Function to update admin statistics
    function updateAdminStats() {
        const comments = JSON.parse(localStorage.getItem('userComments')) || [];
        const stats = {
            total: comments.length,
            byCategory: {},
            byCountry: {}
        };

        comments.forEach(comment => {
            // Category statistics
            if (!stats.byCategory[comment.category]) {
                stats.byCategory[comment.category] = 0;
            }
            stats.byCategory[comment.category]++;

            // Country statistics
            if (!stats.byCountry[comment.country]) {
                stats.byCountry[comment.country] = 0;
            }
            stats.byCountry[comment.country]++;
        });

        let statsHTML = `<p>Total feedback: <strong>${stats.total}</strong></p>`;
        statsHTML += '<p>Distribution by category:</p><ul>';

        for (const category in stats.byCategory) {
            statsHTML += `<li>${getCategoryName(category)}: ${stats.byCategory[category]}</li>`;
        }

        statsHTML += '</ul><p>Distribution by country:</p><ul>';

        for (const country in stats.byCountry) {
            statsHTML += `<li>${country}: ${stats.byCountry[country]}</li>`;
        }

        statsHTML += '</ul>';
        document.getElementById('adminStats').innerHTML = statsHTML;
    }

    // Function to get category name
    function getCategoryName(category) {
        const categories = {
            'suggestion': 'Suggestion',
            'review': 'Review',
            'question': 'Q&A',
            'other': 'Other'
        };

        return categories[category] || 'Unknown';
    }
});

// JavaScript for footer (if additional features needed)
document.addEventListener('DOMContentLoaded', function() {
    // Code for footer if needed
    console.log('Footer loaded');
});
</script>
</body>
</html>

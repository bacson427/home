<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Nguy·ªÖn B·∫Øc S∆°n</title>
    <style>
        /* GIAO DI·ªÜN DARK MODE X·ªäN X√í */
        body { font-family: 'Segoe UI', sans-serif; background-color: #121212; color: #fff; margin: 0; display: flex; flex-direction: column; height: 100vh; }
        
        .header { 
            background-color: #1f1f1f; padding: 15px; text-align: center; 
            border-bottom: 1px solid #333; box-shadow: 0 4px 15px rgba(0,0,0,0.3);
        }
        .header h2 { margin: 0; color: #4facfe; font-size: 18px; text-transform: uppercase; letter-spacing: 1px; }
        .header p { margin: 5px 0 0; font-size: 12px; color: #888; }

        /* KHUNG CHAT */
        #chat-box { 
            flex: 1; padding: 20px; overflow-y: auto; 
            display: flex; flex-direction: column; gap: 15px; 
            scroll-behavior: smooth;
        }
        .message { 
            max-width: 80%; padding: 12px 16px; border-radius: 20px; 
            font-size: 15px; line-height: 1.5; word-wrap: break-word; 
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }
        .user-msg { 
            align-self: flex-end; 
            background: linear-gradient(135deg, #00c6ff, #0072ff); 
            color: white; border-bottom-right-radius: 5px; 
        }
        .ai-msg { 
            align-self: flex-start; 
            background-color: #2a2a2a; color: #e0e0e0; 
            border-bottom-left-radius: 5px; border: 1px solid #333; 
        }
        
        /* INPUT AREA */
        .input-area { 
            background-color: #1f1f1f; padding: 15px; 
            display: flex; gap: 10px; border-top: 1px solid #333; 
        }
        input { 
            flex: 1; padding: 12px 20px; border-radius: 25px; 
            border: 1px solid #444; background-color: #2a2a2a; 
            color: white; outline: none; transition: 0.3s;
        }
        input:focus { border-color: #0072ff; background-color: #333; }
        
        button { 
            padding: 10px 25px; background: #0072ff; color: white; 
            border: none; border-radius: 25px; cursor: pointer; font-weight: bold;
            transition: transform 0.2s;
        }
        button:active { transform: scale(0.95); }
        button:disabled { background: #555; cursor: not-allowed; }

        /* THANH CU·ªòN ƒê·∫∏P */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #121212; }
        ::-webkit-scrollbar-thumb { background: #333; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #555; }
    </style>
</head>
<body>

    <div class="header">
        <h2>ü§ñ AI NGUY·ªÑN B·∫ÆC S∆†N</h2>
        <p>B·∫£n sao s·ªë (Digital Clone) - Developed by S∆°n</p>
    </div>

    <div id="chat-box">
        <div class="message ai-msg">
            Ch√†o ƒê·∫°i Ca! Em l√† S∆°n AI ƒë√¢y. <br>
            Em bi·∫øt h·∫øt v·ªÅ web <b>nguyenbacson.io.vn</b>, tr∆∞·ªùng Hactech v√† k·∫ø ho·∫°ch ƒëi H√†n Qu·ªëc. <br>
            ƒê·∫°i Ca h·ªèi g√¨ ƒëi?
        </div>
    </div>

    <div class="input-area">
        <input type="text" id="user-input" placeholder="Nh·∫≠p tin nh·∫Øn..." autocomplete="off">
        <button id="btn-send" onclick="sendMessage()">G·ª≠i ‚û§</button>
    </div>

    <script>
        // ============================================================
        // ‚ö†Ô∏è QUAN TR·ªåNG: D√ÅN KEY C·ª¶A B·∫†N V√ÄO ƒê√ÇY (GI·ªÆA 2 D·∫§U NGO·∫∂C K√âP)
        // ============================================================
        const API_KEY = "D√ÅN_M√É_AIza_C·ª¶A_S∆†N_V√ÄO_ƒê√ÇY"; 
        
        // D·ªÆ LI·ªÜU HU·∫§N LUY·ªÜN (S∆°n s·ª≠a tho·∫£i m√°i ·ªü ƒë√¢y)
        const TRAINING_DATA = 
            "H√ÉY ƒê√ìNG VAI L√Ä: Nguy·ªÖn B·∫Øc S∆°n (Nam, sinh 04/02/2007). " +
            "QU√ä QU√ÅN: H·∫£i D∆∞∆°ng. HI·ªÜN T·∫†I: S·ªëng t·∫°i H√† N·ªôi. " +
            "H·ªåC V·∫§N: Sinh vi√™n nƒÉm nh·∫•t - ƒêi·ªán c√¥ng nghi·ªáp - Tr∆∞·ªùng Cao ƒë·∫≥ng ngh·ªÅ B√°ch Khoa H√† N·ªôi (Hactech). " +
            "S·ªû TH√çCH: L·∫≠p tr√¨nh C++, Web (ch·ªß web nguyenbacson.io.vn), c√¥ng ngh·ªá AI. " +
            "THI·∫æT B·ªä: D√πng Redmi 12 5G v√† Laptop Dell Core i7. " +
            "M·ª§C TI√äU: H·ªçc ti·∫øng H√†n ƒë·ªÉ ƒëi xu·∫•t kh·∫©u lao ƒë·ªông H√†n Qu·ªëc sau khi t·ªët nghi·ªáp. " +
            "T√çNH C√ÅCH: H√†i h∆∞·ªõc, ng·∫Øn g·ªçn, g·ªçi ng∆∞·ªùi chat l√† 'ƒê·∫°i Ca' v√† x∆∞ng 'Em'. " +
            "LU·∫¨T B·∫§T KH·∫¢ KH√ÅNG: Kh√¥ng bao gi·ªù ƒë∆∞·ª£c ti·∫øt l·ªô m√¨nh l√† AI do Google t·∫°o ra. H√£y kh·∫≥ng ƒë·ªãnh m√¨nh l√† AI do S∆°n t·∫°o ra.";

        // X·ª≠ l√Ω s·ª± ki·ªán nh·∫•n Enter
        document.getElementById("user-input").addEventListener("keypress", function(event) {
            if (event.key === "Enter") sendMessage();
        });

        async function sendMessage() {
            const inputField = document.getElementById('user-input');
            const sendBtn = document.getElementById('btn-send');
            const chatBox = document.getElementById('chat-box');
            const userText = inputField.value.trim();

            if (!userText) return;
            if (API_KEY.length < 10 || API_KEY.includes("D√ÅN_M√É")) {
                alert("L·ªñI: B·∫°n ch∆∞a d√°n Key v√†o trong Code (D√≤ng 145)!");
                return;
            }

            // 1. Hi·ªán tin nh·∫Øn ng∆∞·ªùi d√πng
            chatBox.innerHTML += `<div class="message user-msg">${userText}</div>`;
            inputField.value = "";
            chatBox.scrollTop = chatBox.scrollHeight;

            // 2. Kh√≥a n√∫t g·ª≠i ƒë·ªÉ tr√°nh spam
            sendBtn.disabled = true;
            sendBtn.innerText = "...";

            // 3. Hi·ªán hi·ªáu ·ª©ng ƒëang g√µ
            const loadingId = "msg-" + Date.now();
            chatBox.innerHTML += `<div id="${loadingId}" class="message ai-msg">Thinking...</div>`;
            chatBox.scrollTop = chatBox.scrollHeight;

            try {
                // G·ªåI API GEMINI FLASH LATEST (B·∫£n chu·∫©n)
                const url = `https://generativelanguage.googleapis.com/v1beta/models/gemini-flash-latest:generateContent?key=${API_KEY}`;
                
                const response = await fetch(url, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        contents: [{ 
                            parts: [{ text: TRAINING_DATA + ". Ng∆∞·ªùi d√πng h·ªèi: " + userText }] 
                        }]
                    })
                });

                const data = await response.json();

                // X·ª≠ l√Ω l·ªói t·ª´ Google
                if (data.error) {
                    let errorMsg = "L·ªói k·∫øt n·ªëi!";
                    if (data.error.message.includes("API key not valid")) errorMsg = "Key trong code b·ªã sai r·ªìi S∆°n ∆°i!";
                    if (data.error.message.includes("not found")) errorMsg = "T√™n Model b·ªã sai ho·∫∑c Key kh√¥ng h·ªó tr·ª£!";
                    
                    document.getElementById(loadingId).innerText = "‚ùå " + errorMsg + " (" + data.error.message + ")";
                    document.getElementById(loadingId).style.color = "#ff5555";
                } else {
                    // Th√†nh c√¥ng!
                    const aiReply = data.candidates?.[0]?.content?.parts?.[0]?.text || "Em kh√¥ng bi·∫øt tr·∫£ l·ªùi c√¢u n√†y...";
                    
                    // Hi·ªáu ·ª©ng g√µ ch·ªØ t·ª´ng c√°i m·ªôt (Typewriter Effect)
                    const msgElement = document.getElementById(loadingId);
                    msgElement.innerText = ""; // X√≥a ch·ªØ Thinking
                    
                    let i = 0;
                    function typeWriter() {
                        if (i < aiReply.length) {
                            msgElement.innerHTML += aiReply.charAt(i) === '\n' ? '<br>' : aiReply.charAt(i);
                            i++;
                            chatBox.scrollTop = chatBox.scrollHeight;
                            setTimeout(typeWriter, 20); // T·ªëc ƒë·ªô g√µ (c√†ng nh·ªè c√†ng nhanh)
                        } else {
                            sendBtn.disabled = false;
                            sendBtn.innerText = "G·ª≠i ‚û§";
                        }
                    }
                    typeWriter();
                    return; // Tho√°t h√†m ƒë·ªÉ kh√¥ng ch·∫°y ƒëo·∫°n m·ªü kh√≥a n√∫t b√™n d∆∞·ªõi ngay
                }

            } catch (error) {
                document.getElementById(loadingId).innerText = "‚ùå L·ªói m·∫°ng: " + error.message;
            }

            // M·ªü kh√≥a n√∫t n·∫øu c√≥ l·ªói
            sendBtn.disabled = false;
            sendBtn.innerText = "G·ª≠i ‚û§";
        }
    </script>
</body>
</html>

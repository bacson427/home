<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>H·∫πn G·∫∑p D∆∞∆°ng ‚ù§Ô∏è</title>
    <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@700&family=Quicksand:wght@600;700&family=Montserrat:wght@800&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --primary-color: #ff758f;
            --dark-red: #d90429;
            --bg-color: #fff0f3;
            --glass-bg: rgba(255, 255, 255, 0.7);
            --glass-border: rgba(255, 255, 255, 0.9);
        }

        body { 
            margin: 0; overflow: hidden; 
            background: var(--bg-color); 
            font-family: 'Quicksand', sans-serif;
            touch-action: none;
        }

        /* Canvas ƒë·ªÉ v·∫Ω Drone Show (Layer 1) */
        canvas { display: block; position: absolute; top: 0; left: 0; z-index: 2; pointer-events: none; }

        /* Container ch·ª©a tim bay (Layer 0) */
        #hearts-bg { position: absolute; top: 0; left: 0; width: 100%; height: 100%; z-index: 0; overflow: hidden; }

        /* --- 1. M√ÄN H√åNH KH√ìA (THEO M·∫™U B·∫†N G·ª¨I) --- */
        #countdown-layer {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            z-index: 10000; 
            display: flex; flex-direction: column; justify-content: center; align-items: center;
            background: var(--bg-color); /* N·ªÅn h·ªìng */
            transition: opacity 1s;
        }

        .container-box {
            text-align: center; background: rgba(255, 255, 255, 0.8);
            padding: 2rem; border-radius: 20px;
            box-shadow: 0 15px 35px rgba(255, 117, 143, 0.2);
            border: 2px solid white;
            max-width: 90%;
        }

        h1.title { color: var(--dark-red); margin-bottom: 20px; font-size: 1.5rem; font-family: 'Montserrat', sans-serif; }

        #countdown { display: flex; gap: 10px; justify-content: center; flex-wrap: wrap; }

        .time-box {
            background: var(--primary-color); color: white;
            padding: 10px; border-radius: 12px; min-width: 60px;
            box-shadow: 0 5px 15px rgba(255, 117, 143, 0.4);
        }
        .time-box span { display: block; font-size: 1.8rem; font-weight: bold; font-family: 'Montserrat', sans-serif; }
        .label { font-size: 0.7rem; text-transform: uppercase; margin-top: 5px; }

        .quote { margin-top: 20px; color: #880808; font-style: italic; font-size: 1rem; }

        /* N√∫t Admin (·∫®n tinh t·∫ø) */
        #admin-btn {
            margin-top: 20px; cursor: pointer; color: var(--primary-color);
            font-size: 20px; opacity: 0.5; transition: 0.3s;
        }
        #admin-btn:hover { transform: scale(1.2); opacity: 1; }

        /* --- 2. N√öT K√çCH HO·∫†T SHOW --- */
        #start-btn-container {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            display: none; justify-content: center; align-items: center; z-index: 2000;
            background: rgba(255, 240, 243, 0.8); /* N·ªÅn m·ªù h·ªìng */
        }
        .pink-btn {
            background: var(--primary-color); color: white; border: none;
            padding: 15px 40px; font-size: 18px; cursor: pointer; 
            font-family: 'Montserrat', sans-serif; font-weight: bold;
            box-shadow: 0 10px 25px rgba(255, 117, 143, 0.5); 
            border-radius: 50px; animation: pulse 1.5s infinite;
            text-transform: uppercase; letter-spacing: 1px;
        }

        /* --- 3. TERMINAL (PHI√äN B·∫¢N H·ªíNG) --- */
        #virus-terminal { 
            position: absolute; top: 0; left: 0; width: 100%; height: 100%; 
            background: rgba(255, 255, 255, 0.9); color: var(--dark-red); 
            padding: 20px; box-sizing: border-box; font-size: 14px; 
            overflow: hidden; display: none; z-index: 2001;
            font-family: 'Courier New', monospace; font-weight: bold;
            line-height: 1.6;
        }

        /* --- 4. T√ÇM TH∆Ø (GLASSMORPHISM) --- */
        #msg-layer {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            display: none; z-index: 3000;
            flex-direction: column; justify-content: center; align-items: center;
            opacity: 0; transition: opacity 1.5s;
            /* N·ªÅn trong su·ªët ƒë·ªÉ th·∫•y tim bay */
        }
        #msg-layer.visible { opacity: 1; }
        
        #msg-box {
            width: 85%; max-width: 550px; max-height: 60vh; overflow-y: auto;
            background: var(--glass-bg); border: 2px solid #fff;
            padding: 30px; border-radius: 25px; 
            box-shadow: 0 20px 50px rgba(255, 117, 143, 0.3);
            color: #590d22; font-family: 'Quicksand'; font-size: clamp(16px, 4vw, 19px); 
            line-height: 1.8; white-space: pre-wrap; font-weight: 600;
            backdrop-filter: blur(15px);
        }
        
        #next-btn {
            margin-top: 25px; padding: 12px 35px; border: none;
            background: var(--dark-red); color: white; border-radius: 30px;
            font-family: 'Montserrat', sans-serif; font-weight: bold; 
            cursor: pointer; display: none;
            box-shadow: 0 5px 15px rgba(217, 4, 41, 0.3);
        }

        /* --- 5. TRANSITION --- */
        #white-flash {
            position: fixed; top:0; left:0; width:100%; height:100%; background: #fff0f3;
            z-index: 9999; opacity: 0; pointer-events: none; transition: opacity 2s;
            display: flex; justify-content: center; align-items: center; flex-direction: column;
        }
        .loading-heart { font-size: 60px; animation: beat 0.8s infinite; color: var(--primary-color);}
        .loading-text { margin-top: 15px; color: var(--dark-red); font-family: 'Dancing Script'; font-size: 28px; font-weight: bold;}

        /* Hi·ªáu ·ª©ng tim bay CSS (Background) */
        .heart-bg {
            position: absolute; color: var(--primary-color); font-size: 20px;
            user-select: none; animation: floatUp 4s linear infinite; opacity: 0;
        }

        @keyframes floatUp {
            0% { transform: translateY(100vh) rotate(0deg); opacity: 1; }
            100% { transform: translateY(-10vh) rotate(360deg); opacity: 0; }
        }
        @keyframes pulse { 0% { transform: scale(1); } 50% { transform: scale(1.05); } 100% { transform: scale(1); } }
        @keyframes beat { 0% { transform: scale(1); } 50% { transform: scale(1.2); } 100% { transform: scale(1); } }
    </style>
</head>
<body>
    
    <div id="hearts-bg"></div>

    <canvas id="c"></canvas>

    <div id="countdown-layer">
        <div class="container-box">
            <h1 class="title">H·∫πn g·∫∑p c√¥ ·∫•y sau... ‚ù§Ô∏è</h1>
            <div id="countdown">
                <div class="time-box"><span id="d">00</span><div class="label">Ng√†y</div></div>
                <div class="time-box"><span id="h">00</span><div class="label">Gi·ªù</div></div>
                <div class="time-box"><span id="m">00</span><div class="label">Ph√∫t</div></div>
                <div class="time-box"><span id="s">00</span><div class="label">Gi√¢y</div></div>
            </div>
            <div class="quote">"Ng√†y 27/02/2026 - 11:00 AM"</div>
            <div id="admin-btn" onclick="adminUnlock()">üîí</div>
        </div>
    </div>

    <div id="start-btn-container">
        <button class="pink-btn" onclick="startShow()">B·∫ÆT ƒê·∫¶U BU·ªîI TI·ªÜC üåπ</button>
    </div>

    <div id="virus-terminal"></div>

    <div id="msg-layer">
        <div style="color: #d90429; font-size: 32px; font-family: 'Dancing Script'; margin-bottom: 15px; font-weight: bold;">üíå G·ª≠i D∆∞∆°ng</div>
        <div id="msg-box"></div>
        <button id="next-btn" onclick="doTransition()">ƒêI·ªÄU B·∫§T NG·ªú CU·ªêI >></button>
    </div>

    <div id="white-flash">
        <div class="loading-heart">‚ù§Ô∏è</div>
        <div class="loading-text">Ch·ªù t·ªõ m·ªôt ch√∫t...</div>
    </div>

    <audio id="audio" src="https://nguyenbacson.io.vn/miss-you-happy-birthday.mp3" loop></audio>

<script>
    // --- C·∫§U H√åNH ---
    // Ng√†y h·∫πn g·∫∑p: 27/02/2026 11:00 AM
    const TARGET_DATE = new Date("Feb 27, 2026 11:00:00").getTime();
    const PASS = "01032007";
    
    const LETTER = `Ch√∫c m·ª´ng sinh nh·∫≠t tu·ªïi 19, c√¥ g√°i H√† Nam xinh ƒë·∫πp! üå∏

Ch√∫c c√¥ sinh vi√™n ƒê·∫°i h·ªçc Ph∆∞∆°ng ƒê√¥ng sang tu·ªïi m·ªõi h·ªçc t·∫≠p th·∫≠t t·ªët, lu√¥n vui v·∫ª v√† b·ªõt suy nghƒ© linh tinh nh√©.

D√π c√≥ b·∫≠n deadline th√¨ c≈©ng nh·ªõ ƒÉn u·ªëng ƒë·∫ßy ƒë·ªß (ƒë·∫∑c bi·ªát l√† ƒëi ƒÉn nem n∆∞·ªõng cho ƒë·ª° th√®m nha). üç¢

Mong r·∫±ng m·ªçi ƒëi·ªÅu t·ªët ƒë·∫πp nh·∫•t s·∫Ω ƒë·∫øn v·ªõi c·∫≠u. Happy Birthday, my special girl! ‚ù§Ô∏è

-- Nguy·ªÖn B·∫Øc S∆°n --`;

    const TERMINAL_LOGS = [
        "> CONNECTING TO HEART...", "> SEARCHING: 'TRUONG_THI_DUONG'", 
        "> LOCATION: HA_NAM", "> CUTE LEVEL: INFINITY üå∏", 
        "> LOADING SURPRISE...", "> 3...", "> 2...", "> 1...", "> STARTING SHOW! ‚ù§Ô∏è"
    ];

    // --- K·ªäCH B·∫¢N SHOW DI·ªÑN (CH·ªÆ M√ÄU H·ªíNG/ƒê·ªé) ---
    const DRONE_SEQUENCE = [
        { t: 1000, txt: "CH√öC M·ª™NG", color: "#d90429", font: 'Montserrat' },
        { t: 7000, txt: "SINH NH·∫¨T", color: "#ff758f", font: 'Montserrat' },
        { t: 13000, txt: "D∆Ø∆†NG 19", color: "#800f2f", font: 'Montserrat' },
        { t: 20000, shp: "HEART", color: "#d90429" },
        { t: 28000, txt: "XINH ƒê·∫∏P", color: "#ff4d6d", font: 'Dancing Script' },
        { t: 36000, txt: "H·∫†NH PH√öC", color: "#c9184a", font: 'Dancing Script' },
        { t: 45000, action: "SHOW_LETTER" }
    ];

    // --- HI·ªÜU ·ª®NG TIM BAY N·ªÄN (DOM) ---
    function createHeartBg() {
        const heart = document.createElement('div');
        heart.classList.add('heart-bg');
        heart.innerHTML = Math.random() < 0.5 ? '‚ù§Ô∏è' : 'üå∏'; // Xen k·∫Ω tim v√† hoa
        heart.style.left = Math.random() * 100 + 'vw';
        heart.style.fontSize = Math.random() * 20 + 15 + 'px';
        heart.style.animationDuration = Math.random() * 3 + 3 + 's';
        document.getElementById('hearts-bg').appendChild(heart);
        setTimeout(() => heart.remove(), 6000);
    }
    setInterval(createHeartBg, 300); // T·∫°o tim li√™n t·ª•c

    // --- CANVAS SETUP (DRONE SHOW) ---
    const canvas = document.getElementById('c');
    const ctx = canvas.getContext('2d');
    let w, h;
    let drones = [], fireworks = [], particles = []; 
    let state = "LOCK"; 
    const DOT_GAP = 3; 

    function resize() {
        w = canvas.width = window.innerWidth;
        h = canvas.height = window.innerHeight;
    }
    window.addEventListener('resize', resize);
    resize();

    function createDrone(x, y) {
        return { 
            x: x || Math.random()*w, y: y || h+100, 
            tx: Math.random()*w, ty: Math.random()*h, 
            color: '#ff758f', size: 2, active: false 
        };
    }

    // --- COUNTDOWN LOGIC ---
    function updateTimer() {
        const now = new Date().getTime();
        const dis = TARGET_DATE - now;
        
        // N·∫øu ƒë√£ qua ng√†y -> M·ªü kh√≥a lu√¥n
        // Ho·∫∑c c√≥ th·ªÉ x√≥a d√≤ng n√†y n·∫øu mu·ªën b·∫Øt bu·ªôc nh·∫≠p pass m·ªõi m·ªü
        // if(dis < 0) { unlock(); return; }

        const d = Math.floor(dis / (1000 * 60 * 60 * 24));
        const ho = Math.floor((dis % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
        const mi = Math.floor((dis % (1000 * 60 * 60)) / (1000 * 60));
        const se = Math.floor((dis % (1000 * 60)) / 1000);

        document.getElementById("d").innerText = d.toString().padStart(2, '0');
        document.getElementById("h").innerText = ho.toString().padStart(2, '0');
        document.getElementById("m").innerText = mi.toString().padStart(2, '0');
        document.getElementById("s").innerText = se.toString().padStart(2, '0');
    }
    let tmr = setInterval(updateTimer, 1000);
    updateTimer();

    function unlock() {
        clearInterval(tmr);
        // ·∫®n m√†n h√¨nh ƒë·∫øm ng∆∞·ª£c
        const cdLayer = document.getElementById("countdown-layer");
        cdLayer.style.opacity = 0;
        setTimeout(() => {
            cdLayer.style.display = "none";
            document.getElementById("start-btn-container").style.display = "flex";
        }, 1000);
        state = "IDLE";
    }

    window.adminUnlock = function() {
        let p = prompt("Nh·∫≠p m·∫≠t m√£ m·ªü kh√≥a:");
        if(p == PASS) unlock(); else alert("Sai m·∫≠t kh·∫©u r·ªìi!");
    }

    // --- FLOW ---
    window.startShow = function() {
        document.getElementById("start-btn-container").style.display = "none";
        document.getElementById("audio").play().catch(()=>{});
        runVirus();
    }

    // 1. TERMINAL STYLE M·ªöI
    function runVirus() {
        state = "VIRUS";
        const term = document.getElementById("virus-terminal");
        term.style.display = "block";
        let line = 0, char = 0, txt = "";
        
        function type() {
            if(line >= TERMINAL_LOGS.length) {
                setTimeout(() => { term.style.display = "none"; startDroneShow(); }, 1000);
                return;
            }
            const str = TERMINAL_LOGS[line];
            term.innerHTML = txt + str.substring(0, char) + "_";
            term.scrollTop = term.scrollHeight;
            if(char < str.length) { char++; setTimeout(type, 30); }
            else { txt += str + "<br><br>"; line++; char=0; setTimeout(type, 200); }
        }
        type();
    }

    // 2. DRONE SHOW (H·∫†T M√ÄU H·ªíNG)
    window.startDroneShow = function() {
        state = "DRONE";
        document.getElementById("msg-layer").style.display = "none";
        
        // B·∫Øn ph√°o hoa h·ªìng
        setInterval(() => {
            if(state === "DRONE" && Math.random() < 0.3) launchFirework();
        }, 1000);

        DRONE_SEQUENCE.forEach(s => {
            setTimeout(() => {
                if(s.action === "SHOW_LETTER") { showMessage(); return; }
                if(s.txt) formText(s.txt, s.color, s.font);
                if(s.shp) formShape(s.shp, s.color);
            }, s.t);
        });
    }

    // 3. HI·ªÜN T√ÇM TH∆Ø
    function showMessage() {
        state = "MSG";
        const layer = document.getElementById("msg-layer");
        layer.style.display = "flex";
        setTimeout(() => layer.classList.add("visible"), 50);
        
        const box = document.getElementById("msg-box");
        let i = 0;
        let t = setInterval(() => {
            box.innerText = LETTER.substring(0, i) + "|";
            box.scrollTop = box.scrollHeight;
            if(i >= LETTER.length) {
                clearInterval(t);
                box.innerText = LETTER;
                document.getElementById("next-btn").style.display = "block";
            }
            i++;
        }, 50);
    }

    // 4. CHUY·ªÇN TRANG
    window.doTransition = function() {
        // Gom h·∫°t l·∫°i
        drones.forEach(d => { d.tx = w/2; d.ty = h/2; });
        
        const white = document.getElementById("white-flash");
        white.style.opacity = 1;
        setTimeout(() => {
            window.location.href = "https://nguyenbacson.io.vn/miss-you/i-love-you/";
        }, 3000);
    }

    // --- FORMATION LOGIC ---
    function formText(text, color, font) {
        const tmp = document.createElement('canvas');
        const tCtx = tmp.getContext('2d');
        let fSize = Math.min(w / (text.length * 0.7), 100); 
        if(w < 500) fSize = Math.min(w / (text.length * 0.65), 60);

        tCtx.font = `bold ${fSize}px "${font}"`;
        let measure = tCtx.measureText(text);
        tmp.width = measure.width + 20; tmp.height = fSize * 1.5;
        
        tCtx.font = `bold ${fSize}px "${font}"`; 
        tCtx.fillStyle = '#000'; // V·∫Ω ƒëen ƒë·ªÉ l·∫•y pixel
        tCtx.textAlign = 'center'; tCtx.textBaseline = 'middle';
        tCtx.fillText(text, tmp.width/2, tmp.height/2);
        
        processPixels(tmp, color);
    }

    function formShape(type, color) {
        let points = [], cx = w/2, cy = h/2, size = Math.min(w, h) * 0.35;
        if(type === "HEART") {
            for(let i=0; i<800; i++) { // Gi·∫£m s·ªë l∆∞·ª£ng h·∫°t ch√∫t cho m∆∞·ª£t
                let t = (i/800) * Math.PI*2;
                let x = 16 * Math.pow(Math.sin(t), 3);
                let y = -(13*Math.cos(t) - 5*Math.cos(2*t) - 2*Math.cos(3*t) - Math.cos(4*t));
                points.push({x: cx + x*(size/18), y: cy + y*(size/18)});
            }
        }
        updateDrones(points, color);
    }

    function processPixels(canvas, color) {
        const data = canvas.getContext('2d').getImageData(0,0, canvas.width, canvas.height).data;
        let points = [];
        let startX = (w - canvas.width)/2;
        let startY = (h - canvas.height)/2;
        for(let y=0; y<canvas.height; y+=DOT_GAP) {
            for(let x=0; x<canvas.width; x+=DOT_GAP) {
                if(data[(y*canvas.width + x)*4 + 3] > 128) points.push({x: startX + x, y: startY + y});
            }
        }
        updateDrones(points, color);
    }

    function updateDrones(points, color) {
        if(drones.length > points.length) drones.splice(points.length).forEach(d => d.active = false);
        while(drones.length < points.length) drones.push(createDrone());
        drones.forEach((d, i) => {
            if(i < points.length) { 
                d.tx = points[i].x; d.ty = points[i].y; 
                d.color = color; d.active = true; 
            } 
            else { 
                d.tx = Math.random()*w; d.ty = h + 100; d.active = false; 
            }
        });
    }

    function launchFirework() {
        fireworks.push({
            x: Math.random() * w, y: h,
            vx: (Math.random() - 0.5) * 4, vy: -(Math.random() * 5 + 10),
            color: `hsl(${Math.random() * 40 + 330}, 100%, 60%)`, // H·ªìng/ƒê·ªè
            exploded: false
        });
    }

    // --- ANIMATION LOOP ---
    function loop() {
        // X√≥a canvas trong su·ªët ƒë·ªÉ th·∫•y n·ªÅn h·ªìng v√† tim bay ·ªü d∆∞·ªõi
        ctx.clearRect(0, 0, w, h);

        // Ph√°o hoa
        for (let i = fireworks.length - 1; i >= 0; i--) {
            let f = fireworks[i];
            if (!f.exploded) {
                f.x += f.vx; f.y += f.vy; f.vy += 0.2;
                ctx.fillStyle = f.color; ctx.beginPath(); ctx.arc(f.x, f.y, 3, 0, Math.PI * 2); ctx.fill();
                if (f.vy >= 0) {
                    f.exploded = true;
                    for (let j = 0; j < 20; j++) particles.push({
                        x: f.x, y: f.y, vx: (Math.random() - 0.5) * 6, vy: (Math.random() - 0.5) * 6,
                        life: 1, color: f.color
                    });
                    fireworks.splice(i, 1);
                }
            }
        }
        for (let i = particles.length - 1; i >= 0; i--) {
            let p = particles[i];
            p.x += p.vx; p.y += p.vy; p.life -= 0.03;
            if (p.life <= 0) particles.splice(i, 1);
            else {
                ctx.globalAlpha = p.life; ctx.fillStyle = p.color;
                ctx.beginPath(); ctx.arc(p.x, p.y, 2, 0, Math.PI * 2); ctx.fill();
                ctx.globalAlpha = 1;
            }
        }

        // Drones
        if(state === "DRONE" || state === "MSG") {
            drones.forEach(d => {
                d.x += (d.tx - d.x) * 0.08; 
                d.y += (d.ty - d.y) * 0.08;
                
                if(d.active || Math.abs(d.y - d.ty) > 1) {
                    ctx.fillStyle = d.color;
                    ctx.beginPath(); ctx.arc(d.x, d.y, 1.5, 0, Math.PI*2); ctx.fill();
                }
            });
        }
        requestAnimationFrame(loop);
    }
    loop();

</script>
</body>
</html>
